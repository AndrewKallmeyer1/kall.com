{"ast":null,"code":"import { VideoElement } from \"./chunk.WWUUJDIN.js\";\nimport { __decorateClass } from \"./chunk.LNH2V2XS.js\";\n\n// src/providers/hls/HlsElement.ts\nimport { isHlsjsSupported, isNil, isString as isString2, isUndefined as isUndefined2, preconnect, VdsEvent, vdsEvent } from \"@vidstack/foundation\";\nimport { property } from \"lit/decorators.js\";\n\n// src/providers/hls/utils.ts\nimport { isFunction, isString, isUndefined, kebabToCamelCase, ScriptLoader } from \"@vidstack/foundation\";\nvar HLS_CTOR_CACHE = /* @__PURE__ */new Map();\nfunction isHlsConstructorCached(src) {\n  return HLS_CTOR_CACHE.has(src);\n}\nasync function importHlsConstructor(importer, callbacks = {}) {\n  if (isUndefined(importer)) return void 0;\n  callbacks.onLoadStart?.();\n  if (!isFunction(importer)) {\n    callbacks.onLoaded?.(importer);\n    return importer;\n  }\n  const cacheKey = String(importer);\n  if (HLS_CTOR_CACHE.has(cacheKey)) {\n    const hlsCtor = HLS_CTOR_CACHE.get(cacheKey);\n    callbacks.onLoaded?.(hlsCtor);\n    return hlsCtor;\n  }\n  try {\n    const hlsCtor = (await importer())?.default;\n    if (hlsCtor && !!hlsCtor.isSupported) {\n      callbacks.onLoaded?.(hlsCtor);\n      HLS_CTOR_CACHE.set(cacheKey, hlsCtor);\n    } else {\n      throw Error(true ? \"[vds]: Failed importing `hls.js`. Dynamic import returned invalid constructor.\" : \"\");\n    }\n    return hlsCtor;\n  } catch (err) {\n    callbacks.onLoadError?.(err);\n  }\n  return void 0;\n}\nasync function loadHlsConstructorScript(src, callbacks = {}) {\n  if (!isString(src)) return void 0;\n  if (HLS_CTOR_CACHE.has(src)) return HLS_CTOR_CACHE.get(src);\n  callbacks.onLoadStart?.();\n  try {\n    await ScriptLoader.load(src);\n    if (!isFunction(window.Hls)) {\n      throw Error(true ? \"[vds]: Failed loading `hls.js`. Could not find a valid Hls constructor on window\" : \"\");\n    }\n    const ctor = window.Hls;\n    callbacks.onLoaded?.(ctor);\n    HLS_CTOR_CACHE.set(src, ctor);\n    return ctor;\n  } catch (err) {\n    callbacks.onLoadError?.(err);\n  }\n  return void 0;\n}\nfunction vdsToHlsEventType(type) {\n  return kebabToCamelCase(type.replace(\"vds-\", \"\"));\n}\nvar vdsHlsEventPrefix = \"vds-hls-\";\nvar vdsHlsEvents = [\"lib-load\", \"instance\", \"unsupported\"];\nfunction isHlsEventType(type) {\n  return type.startsWith(vdsHlsEventPrefix) && !vdsHlsEvents.some(t => type.startsWith(`${vdsHlsEventPrefix}${t}`));\n}\n\n// src/providers/hls/HlsElement.ts\nvar HLS_EXTENSIONS = /\\.(m3u8)($|\\?)/i;\nvar HLS_TYPES = /* @__PURE__ */new Set([\"application/vnd.apple.mpegurl\", \"audio/mpegurl\", \"audio/x-mpegurl\", \"application/x-mpegurl\", \"video/x-mpegurl\", \"video/mpegurl\", \"application/mpegurl\"]);\nvar HLS_CDN_SRC_BASE = \"https://cdn.jsdelivr.net/npm/hls.js@^1.0.0/dist/hls.light\";\nvar HLS_CDN_SRC_DEV = `${HLS_CDN_SRC_BASE}.js`;\nvar HLS_CDN_SRC_PROD = `${HLS_CDN_SRC_BASE}.min.js`;\nvar HlsElement = class extends VideoElement {\n  constructor() {\n    super();\n    this._isHlsEngineAttached = false;\n    this.hlsConfig = {};\n    this.hlsLibrary = true ? HLS_CDN_SRC_DEV : HLS_CDN_SRC_PROD;\n    this._currentHlsSrc = \"\";\n    this._hlsEventListeners = [];\n    Object.defineProperty(this, \"hls-config\", {\n      set: config => {\n        this.hlsConfig = config;\n      }\n    });\n    Object.defineProperty(this, \"hls-library\", {\n      set: lib => {\n        this.hlsLibrary = lib;\n      }\n    });\n  }\n  get Hls() {\n    return this._Hls;\n  }\n  get hlsEngine() {\n    return this._hlsEngine;\n  }\n  get isHlsEngineAttached() {\n    return this._isHlsEngineAttached;\n  }\n  get currentHlsSrc() {\n    return this._currentHlsSrc;\n  }\n  async update(changedProperties) {\n    super.update(changedProperties);\n    if (changedProperties.has(\"hlsLibrary\") && isHlsjsSupported()) {\n      this._preconnectToHlsLibDownload();\n    }\n  }\n  destroy() {\n    this._destroyHlsEngine();\n    super.destroy();\n  }\n  get isHlsSupported() {\n    return this.Hls?.isSupported() ?? isHlsjsSupported();\n  }\n  get isHlsStream() {\n    return this.state.src.some(src => HLS_EXTENSIONS.test(src));\n  }\n  _preconnectToHlsLibDownload() {\n    if (this.canLoad || !isString2(this.hlsLibrary) || isHlsConstructorCached(this.hlsLibrary)) {\n      return;\n    }\n    if (true) {\n      this._logger?.infoGroup(\"Preconnect to `hls.js` download\").labelledLog(\"URL\", this.hlsLibrary).dispatch();\n    }\n    preconnect(this.hlsLibrary);\n  }\n  async _buildHlsEngine(forceRebuild = false) {\n    if (isNil(this.videoElement) && !forceRebuild && !isUndefined2(this.hlsEngine)) {\n      this._logger?.infoGroup(\"\\u{1F3D7}\\uFE0F Could not build HLS engine\").labelledLog(\"Video Element\", this.videoElement).labelledLog(\"HLS Engine\", this.hlsEngine).labelledLog(\"Force Rebuild Flag\", forceRebuild).dispatch();\n      return;\n    }\n    if (true) {\n      this._logger?.info(\"\\u{1F3D7}\\uFE0F Building HLS engine\");\n    }\n    if (!isUndefined2(this.hlsEngine)) {\n      this._destroyHlsEngine();\n    }\n    const callbacks = {\n      onLoadStart: () => {\n        if (true) {\n          this._logger?.infoGroup(\"Starting to load `hls.js`\").labelledLog(\"URL\", this.hlsLibrary).dispatch();\n        }\n        this.dispatchEvent(vdsEvent(\"vds-hls-lib-load-start\"));\n      },\n      onLoaded: HlsConstructor => {\n        if (true) {\n          this._logger?.infoGroup(\"Loaded `hls.js`\").labelledLog(\"URL\", this.hlsLibrary).labelledLog(\"Library\", HlsConstructor).dispatch();\n        }\n        this.dispatchEvent(vdsEvent(\"vds-hls-lib-loaded\", {\n          detail: HlsConstructor\n        }));\n      },\n      onLoadError: err => {\n        if (true) {\n          this._logger?.errorGroup(\"Failed to load `hls.js`\").labelledLog(\"Lib Loader\", this.hlsLibrary).labelledLog(\"Error\", err).dispatch();\n        }\n        this.dispatchEvent(vdsEvent(\"vds-hls-lib-load-error\", {\n          detail: err\n        }));\n        this.dispatchEvent(vdsEvent(\"vds-error\", {\n          detail: {\n            message: err.message,\n            code: 4 /* SrcNotSupported */\n          }\n        }));\n      }\n    };\n    this._Hls = await loadHlsConstructorScript(this.hlsLibrary, callbacks);\n    if (isUndefined2(this._Hls) && !isString2(this.hlsLibrary)) {\n      this._Hls = await importHlsConstructor(this.hlsLibrary, callbacks);\n    }\n    if (!this.Hls) {\n      return;\n    }\n    if (!this.Hls?.isSupported?.()) {\n      const message = \"[vds]: `hls.js` is not supported in this environment\";\n      if (true) {\n        this._logger?.error(message);\n      }\n      this.dispatchEvent(vdsEvent(\"vds-hls-unsupported\"));\n      this.dispatchEvent(vdsEvent(\"vds-error\", {\n        detail: {\n          message,\n          code: 4 /* SrcNotSupported */\n        }\n      }));\n      return;\n    }\n    this._hlsEngine = new this.Hls(this.hlsConfig);\n    if (true) {\n      this._logger?.infoGroup(\"\\u{1F3D7}\\uFE0F HLS engine built\").labelledLog(\"Video Element\", this.videoElement).labelledLog(\"HLS Engine\", this.hlsEngine).dispatch();\n    }\n    this.dispatchEvent(vdsEvent(\"vds-hls-instance\", {\n      detail: this.hlsEngine\n    }));\n    this._listenToHlsEngine();\n  }\n  _attachHlsEngine() {\n    if (this.isHlsEngineAttached || isUndefined2(this.hlsEngine) || isNil(this.videoElement)) {\n      return;\n    }\n    this.hlsEngine.attachMedia(this.videoElement);\n    this._isHlsEngineAttached = true;\n    if (true) {\n      this._logger?.infoGroup(\"\\u{1F3D7}\\uFE0F Attached HLS engine\").labelledLog(\"Video Element\", this.videoElement).labelledLog(\"HLS Engine\", this._hlsEngine).dispatch();\n    }\n  }\n  _detachHlsEngine() {\n    if (!this.isHlsEngineAttached) return;\n    this.hlsEngine?.detachMedia();\n    this._isHlsEngineAttached = false;\n    this._currentHlsSrc = \"\";\n    if (true) {\n      this._logger?.infoGroup(\"\\u{1F3D7}\\uFE0F Detached HLS engine\").labelledLog(\"Video Element\", this.videoElement).dispatch();\n    }\n  }\n  _loadSrcOnHlsEngine(src) {\n    if (isNil(this.hlsEngine) || !this.isHlsStream || src === this._currentHlsSrc) {\n      return;\n    }\n    if (true) {\n      this._logger?.infoGroup(`\\u{1F4FC} Loading Source`).labelledLog(\"Src\", src).labelledLog(\"Video Element\", this.videoElement).labelledLog(\"HLS Engine\", this._hlsEngine).dispatch();\n    }\n    this.hlsEngine.loadSource(src);\n    this._currentHlsSrc = src;\n  }\n  _getMediaType() {\n    if (this.state.mediaType === \"live-video\" /* LiveVideo */) {\n      return \"live-video\" /* LiveVideo */;\n    }\n    if (this.isHlsStream) {\n      return \"video\" /* Video */;\n    }\n    return super._getMediaType();\n  }\n  _destroyHlsEngine() {\n    this._hlsEngine?.destroy();\n    this._currentHlsSrc = \"\";\n    this._hlsEngine = void 0;\n    this._isHlsEngineAttached = false;\n    if (true) {\n      this._logger?.info(\"\\u{1F3D7}\\uFE0F Destroyed HLS engine\");\n    }\n  }\n  _handleSrcChange(sources) {\n    if (this._currentHlsSrc.length > 0 && !sources.includes(this._currentHlsSrc)) {\n      sources.push(this._currentHlsSrc);\n    }\n    super._handleSrcChange(sources);\n  }\n  _handleAbort(event) {\n    if (this.isHlsSupported) {\n      for (const src of this.state.src) {\n        if (HLS_EXTENSIONS.test(src)) {\n          this._handleHlsSrcChange(src);\n          return;\n        }\n      }\n    }\n    super._handleAbort(event);\n  }\n  async _handleHlsSrcChange(src) {\n    if (this._currentHlsSrc === src) return;\n    if (!this.hasUpdated || !this.canLoad) return;\n    if (!this.isHlsStream) {\n      this._detachHlsEngine();\n      return;\n    }\n    if (isNil(this.hlsLibrary)) return;\n    if (isUndefined2(this.hlsEngine)) {\n      await this._buildHlsEngine();\n    }\n    if (true) {\n      this._logger?.debug(`\\u{1F4FC} Detected HLS source change \\`${this.state.src}\\``);\n    }\n    this._attachHlsEngine();\n    this._loadSrcOnHlsEngine(src);\n  }\n  _handleLoadedMetadata(event) {\n    super._handleLoadedMetadata(event);\n    this._handleMediaReady({\n      event,\n      duration: this.mediaElement.duration\n    });\n  }\n  _listenToHlsEngine() {\n    if (isUndefined2(this.hlsEngine) || isUndefined2(this.Hls)) return;\n    this.hlsEngine.on(this.Hls.Events.LEVEL_LOADED, this._handleHlsLevelLoaded.bind(this));\n    this._hlsEventListeners.forEach(({\n      type,\n      listener,\n      options\n    }) => {\n      this.hlsEngine?.[options?.once ? \"once\" : \"on\"](type, listener, options?.context);\n    });\n    this.hlsEngine.on(this.Hls.Events.ERROR, this._handleHlsError.bind(this));\n  }\n  _handleHlsError(eventType, data) {\n    if (isUndefined2(this.Hls)) return;\n    if (true) {\n      this._logger?.errorGroup(`HLS error \\`${eventType}\\``).labelledLog(\"Video Element\", this.videoElement).labelledLog(\"HLS Engine\", this._hlsEngine).labelledLog(\"Event Type\", eventType).labelledLog(\"Data\", data).labelledLog(\"Src\", this.state.src).labelledLog(\"State\", {\n        ...this.state\n      }).dispatch();\n    }\n    if (data.fatal) {\n      switch (data.type) {\n        case \"networkError\":\n          this._handleHlsNetworkError();\n          break;\n        case \"mediaError\":\n          this._handleHlsMediaError();\n          break;\n        default:\n          this._handleHlsIrrecoverableError();\n          break;\n      }\n    }\n  }\n  _handleHlsNetworkError() {\n    this.hlsEngine?.startLoad();\n  }\n  _handleHlsMediaError() {\n    this.hlsEngine?.recoverMediaError();\n  }\n  _handleHlsIrrecoverableError() {\n    this._destroyHlsEngine();\n  }\n  _handleHlsLevelLoaded(eventType, data) {\n    if (this.state.canPlay) return;\n    this._handleHlsMediaReady(eventType, data);\n  }\n  _handleHlsMediaReady(eventType, data) {\n    const {\n      live,\n      totalduration: duration\n    } = data.details;\n    const event = new VdsEvent(eventType, {\n      detail: data\n    });\n    const mediaType = live ? \"live-video\" /* LiveVideo */ : \"video\" /* Video */;\n    if (this.state.mediaType !== mediaType) {\n      this.dispatchEvent(vdsEvent(\"vds-media-type-change\", {\n        detail: mediaType,\n        triggerEvent: event\n      }));\n    }\n    if (this.state.duration !== duration) {\n      this.dispatchEvent(vdsEvent(\"vds-duration-change\", {\n        detail: duration,\n        triggerEvent: event\n      }));\n    }\n  }\n  addEventListener(type, listener, options) {\n    if (isHlsEventType(type)) {\n      const hlsEventType = vdsToHlsEventType(type);\n      const hasEventListener = this._hlsEventListeners.some(l => l.type === hlsEventType && l.listener === listener);\n      if (!hasEventListener) {\n        this._hlsEventListeners.push({\n          type: hlsEventType,\n          listener,\n          options\n        });\n        this.hlsEngine?.[options?.once ? \"once\" : \"on\"](hlsEventType, listener, options?.context);\n      }\n      return;\n    }\n    return super.addEventListener(type, listener, options);\n  }\n  removeEventListener(type, listener, options) {\n    if (isHlsEventType(type)) {\n      const hlsEventType = vdsToHlsEventType(type);\n      this._hlsEventListeners = this._hlsEventListeners.filter(l => l.type === hlsEventType && l.listener === listener);\n      this.hlsEngine?.off(hlsEventType, listener, options?.context, options?.once);\n      return;\n    }\n    return super.removeEventListener(type, listener, options);\n  }\n};\n__decorateClass([property({\n  type: Object,\n  attribute: \"hls-config\"\n})], HlsElement.prototype, \"hlsConfig\", 2);\n__decorateClass([property({\n  attribute: \"hls-library\"\n})], HlsElement.prototype, \"hlsLibrary\", 2);\nexport { HLS_EXTENSIONS, HLS_TYPES, HlsElement };","map":{"version":3,"names":["VideoElement","__decorateClass","isHlsjsSupported","isNil","isString","isString2","isUndefined","isUndefined2","preconnect","VdsEvent","vdsEvent","property","isFunction","kebabToCamelCase","ScriptLoader","HLS_CTOR_CACHE","Map","isHlsConstructorCached","src","has","importHlsConstructor","importer","callbacks","onLoadStart","onLoaded","cacheKey","String","hlsCtor","get","default","isSupported","set","Error","err","onLoadError","loadHlsConstructorScript","load","window","Hls","ctor","vdsToHlsEventType","type","replace","vdsHlsEventPrefix","vdsHlsEvents","isHlsEventType","startsWith","some","t","HLS_EXTENSIONS","HLS_TYPES","Set","HLS_CDN_SRC_BASE","HLS_CDN_SRC_DEV","HLS_CDN_SRC_PROD","HlsElement","constructor","_isHlsEngineAttached","hlsConfig","hlsLibrary","_currentHlsSrc","_hlsEventListeners","Object","defineProperty","config","lib","_Hls","hlsEngine","_hlsEngine","isHlsEngineAttached","currentHlsSrc","update","changedProperties","_preconnectToHlsLibDownload","destroy","_destroyHlsEngine","isHlsSupported","isHlsStream","state","test","canLoad","_logger","infoGroup","labelledLog","dispatch","_buildHlsEngine","forceRebuild","videoElement","info","dispatchEvent","HlsConstructor","detail","errorGroup","message","code","error","_listenToHlsEngine","_attachHlsEngine","attachMedia","_detachHlsEngine","detachMedia","_loadSrcOnHlsEngine","loadSource","_getMediaType","mediaType","_handleSrcChange","sources","length","includes","push","_handleAbort","event","_handleHlsSrcChange","hasUpdated","debug","_handleLoadedMetadata","_handleMediaReady","duration","mediaElement","on","Events","LEVEL_LOADED","_handleHlsLevelLoaded","bind","forEach","listener","options","once","context","ERROR","_handleHlsError","eventType","data","fatal","_handleHlsNetworkError","_handleHlsMediaError","_handleHlsIrrecoverableError","startLoad","recoverMediaError","canPlay","_handleHlsMediaReady","live","totalduration","details","triggerEvent","addEventListener","hlsEventType","hasEventListener","l","removeEventListener","filter","off","attribute","prototype"],"sources":["/Users/andrewkallmeyer/kall.com/node_modules/@vidstack/player/dist/dev/chunks/chunk.FSTKN4XK.js"],"sourcesContent":["import {\n  VideoElement\n} from \"./chunk.WWUUJDIN.js\";\nimport {\n  __decorateClass\n} from \"./chunk.LNH2V2XS.js\";\n\n// src/providers/hls/HlsElement.ts\nimport {\n  isHlsjsSupported,\n  isNil,\n  isString as isString2,\n  isUndefined as isUndefined2,\n  preconnect,\n  VdsEvent,\n  vdsEvent\n} from \"@vidstack/foundation\";\nimport { property } from \"lit/decorators.js\";\n\n// src/providers/hls/utils.ts\nimport {\n  isFunction,\n  isString,\n  isUndefined,\n  kebabToCamelCase,\n  ScriptLoader\n} from \"@vidstack/foundation\";\nvar HLS_CTOR_CACHE = /* @__PURE__ */ new Map();\nfunction isHlsConstructorCached(src) {\n  return HLS_CTOR_CACHE.has(src);\n}\nasync function importHlsConstructor(importer, callbacks = {}) {\n  if (isUndefined(importer))\n    return void 0;\n  callbacks.onLoadStart?.();\n  if (!isFunction(importer)) {\n    callbacks.onLoaded?.(importer);\n    return importer;\n  }\n  const cacheKey = String(importer);\n  if (HLS_CTOR_CACHE.has(cacheKey)) {\n    const hlsCtor = HLS_CTOR_CACHE.get(cacheKey);\n    callbacks.onLoaded?.(hlsCtor);\n    return hlsCtor;\n  }\n  try {\n    const hlsCtor = (await importer())?.default;\n    if (hlsCtor && !!hlsCtor.isSupported) {\n      callbacks.onLoaded?.(hlsCtor);\n      HLS_CTOR_CACHE.set(cacheKey, hlsCtor);\n    } else {\n      throw Error(\n        true ? \"[vds]: Failed importing `hls.js`. Dynamic import returned invalid constructor.\" : \"\"\n      );\n    }\n    return hlsCtor;\n  } catch (err) {\n    callbacks.onLoadError?.(err);\n  }\n  return void 0;\n}\nasync function loadHlsConstructorScript(src, callbacks = {}) {\n  if (!isString(src))\n    return void 0;\n  if (HLS_CTOR_CACHE.has(src))\n    return HLS_CTOR_CACHE.get(src);\n  callbacks.onLoadStart?.();\n  try {\n    await ScriptLoader.load(src);\n    if (!isFunction(window.Hls)) {\n      throw Error(\n        true ? \"[vds]: Failed loading `hls.js`. Could not find a valid Hls constructor on window\" : \"\"\n      );\n    }\n    const ctor = window.Hls;\n    callbacks.onLoaded?.(ctor);\n    HLS_CTOR_CACHE.set(src, ctor);\n    return ctor;\n  } catch (err) {\n    callbacks.onLoadError?.(err);\n  }\n  return void 0;\n}\nfunction vdsToHlsEventType(type) {\n  return kebabToCamelCase(type.replace(\"vds-\", \"\"));\n}\nvar vdsHlsEventPrefix = \"vds-hls-\";\nvar vdsHlsEvents = [\"lib-load\", \"instance\", \"unsupported\"];\nfunction isHlsEventType(type) {\n  return type.startsWith(vdsHlsEventPrefix) && !vdsHlsEvents.some((t) => type.startsWith(`${vdsHlsEventPrefix}${t}`));\n}\n\n// src/providers/hls/HlsElement.ts\nvar HLS_EXTENSIONS = /\\.(m3u8)($|\\?)/i;\nvar HLS_TYPES = /* @__PURE__ */ new Set([\n  \"application/vnd.apple.mpegurl\",\n  \"audio/mpegurl\",\n  \"audio/x-mpegurl\",\n  \"application/x-mpegurl\",\n  \"video/x-mpegurl\",\n  \"video/mpegurl\",\n  \"application/mpegurl\"\n]);\nvar HLS_CDN_SRC_BASE = \"https://cdn.jsdelivr.net/npm/hls.js@^1.0.0/dist/hls.light\";\nvar HLS_CDN_SRC_DEV = `${HLS_CDN_SRC_BASE}.js`;\nvar HLS_CDN_SRC_PROD = `${HLS_CDN_SRC_BASE}.min.js`;\nvar HlsElement = class extends VideoElement {\n  constructor() {\n    super();\n    this._isHlsEngineAttached = false;\n    this.hlsConfig = {};\n    this.hlsLibrary = true ? HLS_CDN_SRC_DEV : HLS_CDN_SRC_PROD;\n    this._currentHlsSrc = \"\";\n    this._hlsEventListeners = [];\n    Object.defineProperty(this, \"hls-config\", {\n      set: (config) => {\n        this.hlsConfig = config;\n      }\n    });\n    Object.defineProperty(this, \"hls-library\", {\n      set: (lib) => {\n        this.hlsLibrary = lib;\n      }\n    });\n  }\n  get Hls() {\n    return this._Hls;\n  }\n  get hlsEngine() {\n    return this._hlsEngine;\n  }\n  get isHlsEngineAttached() {\n    return this._isHlsEngineAttached;\n  }\n  get currentHlsSrc() {\n    return this._currentHlsSrc;\n  }\n  async update(changedProperties) {\n    super.update(changedProperties);\n    if (changedProperties.has(\"hlsLibrary\") && isHlsjsSupported()) {\n      this._preconnectToHlsLibDownload();\n    }\n  }\n  destroy() {\n    this._destroyHlsEngine();\n    super.destroy();\n  }\n  get isHlsSupported() {\n    return this.Hls?.isSupported() ?? isHlsjsSupported();\n  }\n  get isHlsStream() {\n    return this.state.src.some((src) => HLS_EXTENSIONS.test(src));\n  }\n  _preconnectToHlsLibDownload() {\n    if (this.canLoad || !isString2(this.hlsLibrary) || isHlsConstructorCached(this.hlsLibrary)) {\n      return;\n    }\n    if (true) {\n      this._logger?.infoGroup(\"Preconnect to `hls.js` download\").labelledLog(\"URL\", this.hlsLibrary).dispatch();\n    }\n    preconnect(this.hlsLibrary);\n  }\n  async _buildHlsEngine(forceRebuild = false) {\n    if (isNil(this.videoElement) && !forceRebuild && !isUndefined2(this.hlsEngine)) {\n      this._logger?.infoGroup(\"\\u{1F3D7}\\uFE0F Could not build HLS engine\").labelledLog(\"Video Element\", this.videoElement).labelledLog(\"HLS Engine\", this.hlsEngine).labelledLog(\"Force Rebuild Flag\", forceRebuild).dispatch();\n      return;\n    }\n    if (true) {\n      this._logger?.info(\"\\u{1F3D7}\\uFE0F Building HLS engine\");\n    }\n    if (!isUndefined2(this.hlsEngine)) {\n      this._destroyHlsEngine();\n    }\n    const callbacks = {\n      onLoadStart: () => {\n        if (true) {\n          this._logger?.infoGroup(\"Starting to load `hls.js`\").labelledLog(\"URL\", this.hlsLibrary).dispatch();\n        }\n        this.dispatchEvent(vdsEvent(\"vds-hls-lib-load-start\"));\n      },\n      onLoaded: (HlsConstructor) => {\n        if (true) {\n          this._logger?.infoGroup(\"Loaded `hls.js`\").labelledLog(\"URL\", this.hlsLibrary).labelledLog(\"Library\", HlsConstructor).dispatch();\n        }\n        this.dispatchEvent(vdsEvent(\"vds-hls-lib-loaded\", { detail: HlsConstructor }));\n      },\n      onLoadError: (err) => {\n        if (true) {\n          this._logger?.errorGroup(\"Failed to load `hls.js`\").labelledLog(\"Lib Loader\", this.hlsLibrary).labelledLog(\"Error\", err).dispatch();\n        }\n        this.dispatchEvent(vdsEvent(\"vds-hls-lib-load-error\", { detail: err }));\n        this.dispatchEvent(\n          vdsEvent(\"vds-error\", {\n            detail: {\n              message: err.message,\n              code: 4 /* SrcNotSupported */\n            }\n          })\n        );\n      }\n    };\n    this._Hls = await loadHlsConstructorScript(this.hlsLibrary, callbacks);\n    if (isUndefined2(this._Hls) && !isString2(this.hlsLibrary)) {\n      this._Hls = await importHlsConstructor(this.hlsLibrary, callbacks);\n    }\n    if (!this.Hls) {\n      return;\n    }\n    if (!this.Hls?.isSupported?.()) {\n      const message = \"[vds]: `hls.js` is not supported in this environment\";\n      if (true) {\n        this._logger?.error(message);\n      }\n      this.dispatchEvent(vdsEvent(\"vds-hls-unsupported\"));\n      this.dispatchEvent(\n        vdsEvent(\"vds-error\", {\n          detail: {\n            message,\n            code: 4 /* SrcNotSupported */\n          }\n        })\n      );\n      return;\n    }\n    this._hlsEngine = new this.Hls(this.hlsConfig);\n    if (true) {\n      this._logger?.infoGroup(\"\\u{1F3D7}\\uFE0F HLS engine built\").labelledLog(\"Video Element\", this.videoElement).labelledLog(\"HLS Engine\", this.hlsEngine).dispatch();\n    }\n    this.dispatchEvent(vdsEvent(\"vds-hls-instance\", { detail: this.hlsEngine }));\n    this._listenToHlsEngine();\n  }\n  _attachHlsEngine() {\n    if (this.isHlsEngineAttached || isUndefined2(this.hlsEngine) || isNil(this.videoElement)) {\n      return;\n    }\n    this.hlsEngine.attachMedia(this.videoElement);\n    this._isHlsEngineAttached = true;\n    if (true) {\n      this._logger?.infoGroup(\"\\u{1F3D7}\\uFE0F Attached HLS engine\").labelledLog(\"Video Element\", this.videoElement).labelledLog(\"HLS Engine\", this._hlsEngine).dispatch();\n    }\n  }\n  _detachHlsEngine() {\n    if (!this.isHlsEngineAttached)\n      return;\n    this.hlsEngine?.detachMedia();\n    this._isHlsEngineAttached = false;\n    this._currentHlsSrc = \"\";\n    if (true) {\n      this._logger?.infoGroup(\"\\u{1F3D7}\\uFE0F Detached HLS engine\").labelledLog(\"Video Element\", this.videoElement).dispatch();\n    }\n  }\n  _loadSrcOnHlsEngine(src) {\n    if (isNil(this.hlsEngine) || !this.isHlsStream || src === this._currentHlsSrc) {\n      return;\n    }\n    if (true) {\n      this._logger?.infoGroup(`\\u{1F4FC} Loading Source`).labelledLog(\"Src\", src).labelledLog(\"Video Element\", this.videoElement).labelledLog(\"HLS Engine\", this._hlsEngine).dispatch();\n    }\n    this.hlsEngine.loadSource(src);\n    this._currentHlsSrc = src;\n  }\n  _getMediaType() {\n    if (this.state.mediaType === \"live-video\" /* LiveVideo */) {\n      return \"live-video\" /* LiveVideo */;\n    }\n    if (this.isHlsStream) {\n      return \"video\" /* Video */;\n    }\n    return super._getMediaType();\n  }\n  _destroyHlsEngine() {\n    this._hlsEngine?.destroy();\n    this._currentHlsSrc = \"\";\n    this._hlsEngine = void 0;\n    this._isHlsEngineAttached = false;\n    if (true) {\n      this._logger?.info(\"\\u{1F3D7}\\uFE0F Destroyed HLS engine\");\n    }\n  }\n  _handleSrcChange(sources) {\n    if (this._currentHlsSrc.length > 0 && !sources.includes(this._currentHlsSrc)) {\n      sources.push(this._currentHlsSrc);\n    }\n    super._handleSrcChange(sources);\n  }\n  _handleAbort(event) {\n    if (this.isHlsSupported) {\n      for (const src of this.state.src) {\n        if (HLS_EXTENSIONS.test(src)) {\n          this._handleHlsSrcChange(src);\n          return;\n        }\n      }\n    }\n    super._handleAbort(event);\n  }\n  async _handleHlsSrcChange(src) {\n    if (this._currentHlsSrc === src)\n      return;\n    if (!this.hasUpdated || !this.canLoad)\n      return;\n    if (!this.isHlsStream) {\n      this._detachHlsEngine();\n      return;\n    }\n    if (isNil(this.hlsLibrary))\n      return;\n    if (isUndefined2(this.hlsEngine)) {\n      await this._buildHlsEngine();\n    }\n    if (true) {\n      this._logger?.debug(`\\u{1F4FC} Detected HLS source change \\`${this.state.src}\\``);\n    }\n    this._attachHlsEngine();\n    this._loadSrcOnHlsEngine(src);\n  }\n  _handleLoadedMetadata(event) {\n    super._handleLoadedMetadata(event);\n    this._handleMediaReady({\n      event,\n      duration: this.mediaElement.duration\n    });\n  }\n  _listenToHlsEngine() {\n    if (isUndefined2(this.hlsEngine) || isUndefined2(this.Hls))\n      return;\n    this.hlsEngine.on(this.Hls.Events.LEVEL_LOADED, this._handleHlsLevelLoaded.bind(this));\n    this._hlsEventListeners.forEach(({ type, listener, options }) => {\n      this.hlsEngine?.[options?.once ? \"once\" : \"on\"](type, listener, options?.context);\n    });\n    this.hlsEngine.on(this.Hls.Events.ERROR, this._handleHlsError.bind(this));\n  }\n  _handleHlsError(eventType, data) {\n    if (isUndefined2(this.Hls))\n      return;\n    if (true) {\n      this._logger?.errorGroup(`HLS error \\`${eventType}\\``).labelledLog(\"Video Element\", this.videoElement).labelledLog(\"HLS Engine\", this._hlsEngine).labelledLog(\"Event Type\", eventType).labelledLog(\"Data\", data).labelledLog(\"Src\", this.state.src).labelledLog(\"State\", { ...this.state }).dispatch();\n    }\n    if (data.fatal) {\n      switch (data.type) {\n        case \"networkError\":\n          this._handleHlsNetworkError();\n          break;\n        case \"mediaError\":\n          this._handleHlsMediaError();\n          break;\n        default:\n          this._handleHlsIrrecoverableError();\n          break;\n      }\n    }\n  }\n  _handleHlsNetworkError() {\n    this.hlsEngine?.startLoad();\n  }\n  _handleHlsMediaError() {\n    this.hlsEngine?.recoverMediaError();\n  }\n  _handleHlsIrrecoverableError() {\n    this._destroyHlsEngine();\n  }\n  _handleHlsLevelLoaded(eventType, data) {\n    if (this.state.canPlay)\n      return;\n    this._handleHlsMediaReady(eventType, data);\n  }\n  _handleHlsMediaReady(eventType, data) {\n    const { live, totalduration: duration } = data.details;\n    const event = new VdsEvent(eventType, { detail: data });\n    const mediaType = live ? \"live-video\" /* LiveVideo */ : \"video\" /* Video */;\n    if (this.state.mediaType !== mediaType) {\n      this.dispatchEvent(\n        vdsEvent(\"vds-media-type-change\", {\n          detail: mediaType,\n          triggerEvent: event\n        })\n      );\n    }\n    if (this.state.duration !== duration) {\n      this.dispatchEvent(\n        vdsEvent(\"vds-duration-change\", {\n          detail: duration,\n          triggerEvent: event\n        })\n      );\n    }\n  }\n  addEventListener(type, listener, options) {\n    if (isHlsEventType(type)) {\n      const hlsEventType = vdsToHlsEventType(type);\n      const hasEventListener = this._hlsEventListeners.some(\n        (l) => l.type === hlsEventType && l.listener === listener\n      );\n      if (!hasEventListener) {\n        this._hlsEventListeners.push({ type: hlsEventType, listener, options });\n        this.hlsEngine?.[options?.once ? \"once\" : \"on\"](hlsEventType, listener, options?.context);\n      }\n      return;\n    }\n    return super.addEventListener(type, listener, options);\n  }\n  removeEventListener(type, listener, options) {\n    if (isHlsEventType(type)) {\n      const hlsEventType = vdsToHlsEventType(type);\n      this._hlsEventListeners = this._hlsEventListeners.filter(\n        (l) => l.type === hlsEventType && l.listener === listener\n      );\n      this.hlsEngine?.off(hlsEventType, listener, options?.context, options?.once);\n      return;\n    }\n    return super.removeEventListener(type, listener, options);\n  }\n};\n__decorateClass([\n  property({ type: Object, attribute: \"hls-config\" })\n], HlsElement.prototype, \"hlsConfig\", 2);\n__decorateClass([\n  property({ attribute: \"hls-library\" })\n], HlsElement.prototype, \"hlsLibrary\", 2);\n\nexport {\n  HLS_EXTENSIONS,\n  HLS_TYPES,\n  HlsElement\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}