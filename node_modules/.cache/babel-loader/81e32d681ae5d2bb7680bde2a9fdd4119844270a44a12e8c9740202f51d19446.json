{"ast":null,"code":"import { mediaProviderDiscoveryId } from \"./chunk.BJN6YOPG.js\";\nimport { __decorateClass } from \"./chunk.LNH2V2XS.js\";\n\n// src/media/manage/MediaVisibilityElement.ts\nimport { discover, DisposalBin, IntersectionController, PageController, vdsEvent } from \"@vidstack/foundation\";\nimport { css, html, LitElement } from \"lit\";\nimport { property } from \"lit/decorators.js\";\nvar MediaVisibilityElement = class extends LitElement {\n  constructor() {\n    super();\n    this.viewportEnterDelay = 0;\n    this.pageChangeType = \"state\";\n    this.pageEnterDelay = 0;\n    this.intersectionThreshold = 1;\n    this._isIntersecting = false;\n    this._providerDisposal = new DisposalBin();\n    this._hasIntersected = false;\n    this.intersectionController = new IntersectionController(this, {\n      root: this.intersectionRoot ? document.querySelector(this.intersectionRoot) : null,\n      threshold: this.intersectionThreshold\n    }, entries => {\n      window.clearTimeout(this._intersectionTimeout);\n      const entry = entries[0];\n      this._isIntersecting = entry.isIntersecting;\n      if (this._hasIntersected) {\n        if (entry.isIntersecting) {\n          this._intersectionTimeout = window.setTimeout(() => {\n            this._triggerOnEnter(this.enterViewport);\n            this._intersectionTimeout = void 0;\n          }, this.viewportEnterDelay);\n        } else if (this.exitViewport) {\n          this._isIntersecting = false;\n          this._triggerOnExit(this.exitViewport);\n        }\n      }\n      this._hasIntersected = true;\n      this._dispatchVisibilityChange();\n    });\n    this.pageController = new PageController(this, ({\n      state,\n      visibility\n    }) => {\n      window.clearTimeout(this._pageTimeout);\n      if (!this.isIntersecting) return;\n      const newState = this.pageChangeType === \"state\" ? state : visibility;\n      if (newState === \"hidden\") {\n        this._triggerOnExit(this.exitPage);\n      } else if (this.enterPage) {\n        this._pageTimeout = window.setTimeout(() => {\n          this._triggerOnEnter(this.enterPage);\n          this._pageTimeout = void 0;\n        }, this.pageEnterDelay);\n      }\n      this._dispatchVisibilityChange();\n    });\n    discover(this, mediaProviderDiscoveryId, (provider, onDisconnect) => {\n      this._handleMediaProviderConnect(provider, onDisconnect);\n    });\n  }\n  static get styles() {\n    return css`\n      :host {\n        display: contents;\n      }\n    `;\n  }\n  get isIntersecting() {\n    return this._isIntersecting;\n  }\n  disconnectedCallback() {\n    super.disconnectedCallback();\n    this._hasIntersected = false;\n    this._providerDisposal.empty();\n  }\n  render() {\n    return html`<slot></slot>`;\n  }\n  get provider() {\n    return this._provider;\n  }\n  _handleMediaProviderConnect(provider, onDisconnect) {\n    this._provider = provider;\n    const unobserve = this.intersectionController.observe(provider);\n    onDisconnect(() => {\n      unobserve();\n      this._provider = void 0;\n      this._providerDisposal.empty();\n    });\n  }\n  _triggerOnEnter(mediaAction) {\n    if (!this._provider) return;\n    if (mediaAction === \"play\") {\n      this._provider.paused = false;\n    } else if (mediaAction === \"unmute\") {\n      this._provider.muted = false;\n    }\n  }\n  _triggerOnExit(mediaAction) {\n    if (!this._provider) return;\n    if (mediaAction === \"pause\") {\n      this._provider.paused = true;\n    } else if (mediaAction === \"mute\") {\n      this._provider.muted = true;\n    }\n  }\n  _dispatchVisibilityChange() {\n    if (!this._provider) return;\n    this.dispatchEvent(vdsEvent(\"vds-media-visibility-change\", {\n      bubbles: true,\n      composed: true,\n      detail: {\n        provider: this._provider,\n        viewport: {\n          isIntersecting: this.isIntersecting\n        },\n        page: {\n          state: this.pageController.state,\n          visibility: this.pageController.visibility\n        }\n      }\n    }));\n  }\n};\n__decorateClass([property({\n  attribute: \"enter-viewport\"\n})], MediaVisibilityElement.prototype, \"enterViewport\", 2);\n__decorateClass([property({\n  attribute: \"exit-viewport\"\n})], MediaVisibilityElement.prototype, \"exitViewport\", 2);\n__decorateClass([property({\n  type: Number,\n  attribute: \"viewport-enter-delay\"\n})], MediaVisibilityElement.prototype, \"viewportEnterDelay\", 2);\n__decorateClass([property({\n  attribute: \"enter-page\"\n})], MediaVisibilityElement.prototype, \"enterPage\", 2);\n__decorateClass([property({\n  attribute: \"exit-page\"\n})], MediaVisibilityElement.prototype, \"exitPage\", 2);\n__decorateClass([property({\n  attribute: \"page-change-type\"\n})], MediaVisibilityElement.prototype, \"pageChangeType\", 2);\n__decorateClass([property({\n  type: Number,\n  attribute: \"page-enter-delay\"\n})], MediaVisibilityElement.prototype, \"pageEnterDelay\", 2);\n__decorateClass([property({\n  attribute: \"intersection-root\"\n})], MediaVisibilityElement.prototype, \"intersectionRoot\", 2);\n__decorateClass([property({\n  type: Number,\n  attribute: \"intersection-threshold\"\n})], MediaVisibilityElement.prototype, \"intersectionThreshold\", 2);\nexport { MediaVisibilityElement };","map":{"version":3,"names":["mediaProviderDiscoveryId","__decorateClass","discover","DisposalBin","IntersectionController","PageController","vdsEvent","css","html","LitElement","property","MediaVisibilityElement","constructor","viewportEnterDelay","pageChangeType","pageEnterDelay","intersectionThreshold","_isIntersecting","_providerDisposal","_hasIntersected","intersectionController","root","intersectionRoot","document","querySelector","threshold","entries","window","clearTimeout","_intersectionTimeout","entry","isIntersecting","setTimeout","_triggerOnEnter","enterViewport","exitViewport","_triggerOnExit","_dispatchVisibilityChange","pageController","state","visibility","_pageTimeout","newState","exitPage","enterPage","provider","onDisconnect","_handleMediaProviderConnect","styles","disconnectedCallback","empty","render","_provider","unobserve","observe","mediaAction","paused","muted","dispatchEvent","bubbles","composed","detail","viewport","page","attribute","prototype","type","Number"],"sources":["/Users/andrewkallmeyer/kall.com/node_modules/@vidstack/player/dist/dev/chunks/chunk.ZXXE6NEW.js"],"sourcesContent":["import {\n  mediaProviderDiscoveryId\n} from \"./chunk.BJN6YOPG.js\";\nimport {\n  __decorateClass\n} from \"./chunk.LNH2V2XS.js\";\n\n// src/media/manage/MediaVisibilityElement.ts\nimport {\n  discover,\n  DisposalBin,\n  IntersectionController,\n  PageController,\n  vdsEvent\n} from \"@vidstack/foundation\";\nimport { css, html, LitElement } from \"lit\";\nimport { property } from \"lit/decorators.js\";\nvar MediaVisibilityElement = class extends LitElement {\n  constructor() {\n    super();\n    this.viewportEnterDelay = 0;\n    this.pageChangeType = \"state\";\n    this.pageEnterDelay = 0;\n    this.intersectionThreshold = 1;\n    this._isIntersecting = false;\n    this._providerDisposal = new DisposalBin();\n    this._hasIntersected = false;\n    this.intersectionController = new IntersectionController(\n      this,\n      {\n        root: this.intersectionRoot ? document.querySelector(this.intersectionRoot) : null,\n        threshold: this.intersectionThreshold\n      },\n      (entries) => {\n        window.clearTimeout(this._intersectionTimeout);\n        const entry = entries[0];\n        this._isIntersecting = entry.isIntersecting;\n        if (this._hasIntersected) {\n          if (entry.isIntersecting) {\n            this._intersectionTimeout = window.setTimeout(() => {\n              this._triggerOnEnter(this.enterViewport);\n              this._intersectionTimeout = void 0;\n            }, this.viewportEnterDelay);\n          } else if (this.exitViewport) {\n            this._isIntersecting = false;\n            this._triggerOnExit(this.exitViewport);\n          }\n        }\n        this._hasIntersected = true;\n        this._dispatchVisibilityChange();\n      }\n    );\n    this.pageController = new PageController(this, ({ state, visibility }) => {\n      window.clearTimeout(this._pageTimeout);\n      if (!this.isIntersecting)\n        return;\n      const newState = this.pageChangeType === \"state\" ? state : visibility;\n      if (newState === \"hidden\") {\n        this._triggerOnExit(this.exitPage);\n      } else if (this.enterPage) {\n        this._pageTimeout = window.setTimeout(() => {\n          this._triggerOnEnter(this.enterPage);\n          this._pageTimeout = void 0;\n        }, this.pageEnterDelay);\n      }\n      this._dispatchVisibilityChange();\n    });\n    discover(this, mediaProviderDiscoveryId, (provider, onDisconnect) => {\n      this._handleMediaProviderConnect(provider, onDisconnect);\n    });\n  }\n  static get styles() {\n    return css`\n      :host {\n        display: contents;\n      }\n    `;\n  }\n  get isIntersecting() {\n    return this._isIntersecting;\n  }\n  disconnectedCallback() {\n    super.disconnectedCallback();\n    this._hasIntersected = false;\n    this._providerDisposal.empty();\n  }\n  render() {\n    return html`<slot></slot>`;\n  }\n  get provider() {\n    return this._provider;\n  }\n  _handleMediaProviderConnect(provider, onDisconnect) {\n    this._provider = provider;\n    const unobserve = this.intersectionController.observe(provider);\n    onDisconnect(() => {\n      unobserve();\n      this._provider = void 0;\n      this._providerDisposal.empty();\n    });\n  }\n  _triggerOnEnter(mediaAction) {\n    if (!this._provider)\n      return;\n    if (mediaAction === \"play\") {\n      this._provider.paused = false;\n    } else if (mediaAction === \"unmute\") {\n      this._provider.muted = false;\n    }\n  }\n  _triggerOnExit(mediaAction) {\n    if (!this._provider)\n      return;\n    if (mediaAction === \"pause\") {\n      this._provider.paused = true;\n    } else if (mediaAction === \"mute\") {\n      this._provider.muted = true;\n    }\n  }\n  _dispatchVisibilityChange() {\n    if (!this._provider)\n      return;\n    this.dispatchEvent(\n      vdsEvent(\"vds-media-visibility-change\", {\n        bubbles: true,\n        composed: true,\n        detail: {\n          provider: this._provider,\n          viewport: {\n            isIntersecting: this.isIntersecting\n          },\n          page: {\n            state: this.pageController.state,\n            visibility: this.pageController.visibility\n          }\n        }\n      })\n    );\n  }\n};\n__decorateClass([\n  property({ attribute: \"enter-viewport\" })\n], MediaVisibilityElement.prototype, \"enterViewport\", 2);\n__decorateClass([\n  property({ attribute: \"exit-viewport\" })\n], MediaVisibilityElement.prototype, \"exitViewport\", 2);\n__decorateClass([\n  property({ type: Number, attribute: \"viewport-enter-delay\" })\n], MediaVisibilityElement.prototype, \"viewportEnterDelay\", 2);\n__decorateClass([\n  property({ attribute: \"enter-page\" })\n], MediaVisibilityElement.prototype, \"enterPage\", 2);\n__decorateClass([\n  property({ attribute: \"exit-page\" })\n], MediaVisibilityElement.prototype, \"exitPage\", 2);\n__decorateClass([\n  property({ attribute: \"page-change-type\" })\n], MediaVisibilityElement.prototype, \"pageChangeType\", 2);\n__decorateClass([\n  property({ type: Number, attribute: \"page-enter-delay\" })\n], MediaVisibilityElement.prototype, \"pageEnterDelay\", 2);\n__decorateClass([\n  property({ attribute: \"intersection-root\" })\n], MediaVisibilityElement.prototype, \"intersectionRoot\", 2);\n__decorateClass([\n  property({ type: Number, attribute: \"intersection-threshold\" })\n], MediaVisibilityElement.prototype, \"intersectionThreshold\", 2);\n\nexport {\n  MediaVisibilityElement\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}